{"version":3,"sources":["components/home/home.js","userService/userService.js","components/liveCast/footer/footer.js","components/liveCast/liveCast.js","App.js","index.js"],"names":["shortid","require","Home","id","disable","joinDisable","history","useHistory","idRoom","generate","className","Button","variant","size","disabled","onClick","push","axios","deleteId","method","url","data","Footer","isAdmin","screenShare","isPresenting","disconnect","console","log","window","location","hash","LiveCast","setJoinDisable","setDisable","userVideo","useRef","ssVideo","useState","streamObj","setStreamObj","socketRef","useParams","peersRef","peers","setPeers","setIsPresenting","adminId","setIsAdmin","setCanvasStream","setArr","addEventListener","e","returnValue","useEffect","current","io","connect","navigator","mediaDevices","getUserMedia","video","audio","then","stream","canvas","document","getElementById","getDisplayMedia","cursor","screenStream","localStream2","localVideo","localVideo2","hidden","style","width","height","getVideoTracks","getSettings","ctx","getContext","setInterval","h","w","drawImage","srcObject","captureStream","emit","on","users","length","peer","userToAdmin","callerID","Peer","initiator","trickle","signal","createPeer","peerID","prev","payload","incomingSignal","addPeer","item","find","p","class","ref","muted","autoPlay","controls","playsinline","src","URL","createObjectURL","play","map","index","replaceTrack","getTracks","onended","App","setId","get","roomID","exact","path","ReactDOM","render"],"mappings":"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","file":"static/js/main.cc8fc7c8.chunk.js","sourcesContent":["import \"./home.css\";\r\nimport { Button } from \"react-bootstrap\";\r\nimport { useHistory } from \"react-router\";\r\nimport { useEffect } from \"react\";\r\n\r\n\r\nconst shortid = require(\"shortid\");\r\n\r\nconst Home = ({id,disable,joinDisable}) => {\r\n\r\n\tconst history = useHistory();\r\n\tconst idRoom =  shortid.generate();\r\n\r\n// window.location.reload()\r\n\r\n\treturn (\r\n\t\t<div className=\"header\">\r\n\t\t\t<Button\r\n\t\t\t\tvariant=\"primary\"\r\n\t\t\t\tsize=\"lg\"\r\n\t\t\t\tdisabled={disable}\r\n\t\t\t\tonClick={() => {\r\n\t\t\t\t\thistory.push(`${idRoom}#init`);\r\n\t\t\t\t}}\r\n\t\t\t>\r\n\t\t\t\tCreate Broadcast\r\n\t\t\t</Button>\r\n\t\t\t<Button\r\n\t\t\t\tvariant=\"primary\"\r\n\t\t\t\tsize=\"lg\"\r\n\t\t\t\tdisabled={joinDisable}\r\n\t\t\t\tonClick={() => {\r\n\t\t\t\t\thistory.push(`/${id}`);\r\n\t\t\t\t}}\r\n\t\t\t>\r\n\t\t\t\tJoin Now\r\n\t\t\t</Button>\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default Home;\r\n","const axios = require(\"axios\");\r\nexport const fetchId = () => {\r\n\tconst response = axios.get(\"/api\");\r\n\r\n\treturn response;\r\n};\r\n\r\nexport const deleteId = (id) => {\r\n\tconst response = axios({\r\n\t\tmethod: \"delete\",\r\n\t\turl:   `/api/:id`,\r\n\t\tdata: { id: id },\r\n\t});\r\n\treturn response;\r\n};\r\n","import \"./footer.css\";\r\nimport PhoneEnabledIcon from \"@material-ui/icons/PhoneEnabled\";\r\nimport { useHistory } from \"react-router-dom\";\r\nimport DesktopWindowsIcon from \"@material-ui/icons/DesktopWindows\";\r\nimport { deleteId } from \"../../../userService/userService\";\r\n\r\nconst Footer = ({ id, isAdmin, screenShare, isPresenting,disconnect }) => {\r\n\tconst history = useHistory();\r\n\tconsole.log(isAdmin);\r\n\treturn (\r\n\t\t<div className=\"footer-block\">\r\n\t\t\t<div\r\n\t\t\t\tclassName=\"icon-block phone\"\r\n\t\t\t\tonClick={() => {\r\n\t\t\t\t\tif (window.location.hash === \"#init\") {\r\n\t\t\t\t\t\tdeleteId(id);\r\n\t\t\t\t\t}\r\n                    disconnect()\r\n\t\t\t\t\thistory.push(\"/\");\r\n\t\t\t\t}}\r\n\t\t\t>\r\n\t\t\t\t<PhoneEnabledIcon />\r\n\t\t\t</div>\r\n\t\t\t{isAdmin && (\r\n\t\t\t\t<div\r\n\t\t\t\t\tclassName=\"icon-block screen-share\"\r\n\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\tscreenShare();\r\n\t\t\t\t\t}}\r\n\t\t\t\t>\r\n\t\t\t\t\t<DesktopWindowsIcon />\r\n\t\t\t\t\t{isPresenting ? (\r\n\t\t\t\t\t\t<p className=\"title\">Stop now</p>\r\n\t\t\t\t\t) : (\r\n\t\t\t\t\t\t<p className=\"title\">Present now</p>\r\n\t\t\t\t\t)}\r\n\t\t\t\t</div>\r\n\t\t\t)}\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default Footer;\r\n","import \"./liveCast.css\";\r\nimport Footer from \"./footer/footer\";\r\n\r\nimport React, { useEffect, useRef, useState } from \"react\";\r\nimport { useParams, useHistory } from \"react-router-dom\";\r\nimport io from \"socket.io-client\";\r\nimport Peer from \"simple-peer\";\r\nimport axios from \"axios\";\r\nimport { deleteId } from \"../../userService/userService\";\r\nconst shortid = require(\"shortid\");\r\n\r\nconst LiveCast = ({ setJoinDisable, setDisable }) => {\r\n\tconst history = useHistory();\r\n\r\n\tconst userVideo = useRef();\r\n\tconst ssVideo = useRef();\r\n\tconst [streamObj, setStreamObj] = useState();\r\n\tconst socketRef = useRef();\r\n\tconst { id } = useParams();\r\n\tconst peersRef = useRef([]);\r\n\tconst [peers, setPeers] = useState([]);\r\n\tconst [peerVideo, setPeerVideo] = useState([]);\r\n\tconst [isPresenting, setIsPresenting] = useState(false);\r\n\tconst vid = useRef();\r\n\tconst adminId = useRef();\r\n\tconst [isAdmin, setIsAdmin] = useState(false);\r\n\tconst [canvasStream, setCanvasStream] = useState();\r\n\r\n\tconst [arr, setArr] = useState([]);\r\n\r\n\t\r\n\r\n\tif (window.location.hash === \"#init\") {\r\n\t\twindow.addEventListener(\"beforeunload\", function (e) {\r\n\t\t\t// e.preventDefault();\r\n\t\t\tdeleteId(id);\r\n\r\n\t\t\te.returnValue = \"Are you sure you want to exit?\";\r\n\t\t\tconsole.log(e.returnValue);\r\n\t\t});\r\n\t}\r\n\r\n\tuseEffect(() => {\r\n\t\tsocketRef.current = io.connect(\"/\");\r\n\t\tnavigator.mediaDevices\r\n\t\t\t.getUserMedia({ video: true, audio: true })\r\n\t\t\t.then((stream) => {\r\n\t\t\t\tsetStreamObj(stream);\r\n\t\t\t\t//Screen Share\r\n\t\t\t\tvar canvas = document.getElementById(\"localCanvas\");\r\n\r\n\t\t\t\tconsole.log(stream);\r\n\r\n\t\t\t\tif (window.location.hash === \"#init\") {\r\n\t\t\t\t\tnavigator.mediaDevices\r\n\t\t\t\t\t\t//Cursor True is means sending cursor also of the person sharing screen to the person recieving the screen\r\n\t\t\t\t\t\t.getDisplayMedia({ cursor: true })\r\n\t\t\t\t\t\t.then((screenStream) => {\r\n\t\t\t\t\t\t\tlet localStream2 = screenStream;\r\n\t\t\t\t\t\t\tvar localVideo = document.getElementById(\"adminVid\");\r\n\t\t\t\t\t\t\tvar localVideo2 = document.getElementById(\"ssVideo\");\r\n\t\t\t\t\t\t\tlocalVideo2.hidden = false;\r\n\t\t\t\t\t\t\tcanvas.hidden = false;\r\n\t\t\t\t\t\t\tlocalVideo.style.width = \"0\";\r\n\t\t\t\t\t\t\tlocalVideo.style.height = \"0\";\r\n\t\t\t\t\t\t\tlocalVideo2.style.width = \"0\";\r\n\t\t\t\t\t\t\tlocalVideo2.style.height = \"0\";\r\n\r\n\t\t\t\t\t\t\tconsole.log(screenStream.getVideoTracks()[0].getSettings().width);\r\n\t\t\t\t\t\t\tcanvas.width = screenStream\r\n\t\t\t\t\t\t\t\t.getVideoTracks()[0]\r\n\t\t\t\t\t\t\t\t.getSettings().width;\r\n\t\t\t\t\t\t\tcanvas.height = screenStream\r\n\t\t\t\t\t\t\t\t.getVideoTracks()[0]\r\n\t\t\t\t\t\t\t\t.getSettings().height;\r\n\t\t\t\t\t\t\tvar ctx = canvas.getContext(\"2d\");\r\n\t\t\t\t\t\t\t setInterval(() => {\r\n\t\t\t\t\t\t\t\tif (\r\n\t\t\t\t\t\t\t\t\tcanvas.width !==\r\n\t\t\t\t\t\t\t\t\tlocalStream2.getVideoTracks()[0].getSettings().width\r\n\t\t\t\t\t\t\t\t) {\r\n\t\t\t\t\t\t\t\t\tcanvas.width = localStream2\r\n\t\t\t\t\t\t\t\t\t\t.getVideoTracks()[0]\r\n\t\t\t\t\t\t\t\t\t\t.getSettings().width;\r\n\t\t\t\t\t\t\t\t\tcanvas.height = localStream2\r\n\t\t\t\t\t\t\t\t\t\t.getVideoTracks()[0]\r\n\t\t\t\t\t\t\t\t\t\t.getSettings().height;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tlet h = canvas.height - 240;\r\n\t\t\t\t\t\t\t\tlet w = canvas.width - 320;\r\n\t\t\t\t\t\t\t\tctx.drawImage(localVideo2, 0, 0);\r\n\t\t\t\t\t\t\t\tctx.drawImage(localVideo, w, h, 320, 240);\r\n\t\t\t\t\t\t\t}, 33);\r\n\r\n\t\t\t\t\t\t\tif (window.location.hash === \"#init\") {\r\n\t\t\t\t\t\t\t\tuserVideo.current.srcObject = stream;\r\n\t\t\t\t\t\t\t\tadminId.current = socketRef.current.id;\r\n\t\t\t\t\t\t\t\tsetIsAdmin(true);\r\n\t\t\t\t\t\t\t\tssVideo.current.srcObject = screenStream;\r\n\t\t\t\t\t\t\t\tsetStreamObj(stream);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tstream = canvas.captureStream(30);\r\n\t\t\t\t\t\t\tsetCanvasStream(canvas.captureStream(30));\r\n\t\t\t\t\t\t});\r\n\t\t\t\t}\r\n\r\n\t\t\t\tconsole.log(\"JOINED ROOM\");\r\n\t\t\t\tsocketRef.current.emit(\"roomID\", id);\r\n\r\n\t\t\t\tsocketRef.current.on(\"all users\", (users) => {\r\n\t\t\t\t\t//peers is for how many videos are rendering\r\n\t\t\t\t\tconsole.log(users.length);\r\n\t\t\t\t\tsetArr(users);\r\n\t\t\t\t\tconsole.log(socketRef.current);\r\n\t\t\t\t\t//socketRef.current.id is the of user currently joined\r\n\t\t\t\t\t// UserID  id's of all those inside the meeting\r\n\t\t\t\t\tif (users[0] !== socketRef.current.id) {\r\n\t\t\t\t\t\tconst peer = createPeer(users[0], socketRef.current.id, stream);\r\n\t\t\t\t\t\tconsole.log(stream);\r\n\t\t\t\t\t\t//peersRef is for which is having connection with which\r\n\t\t\t\t\t\tpeersRef.current.push({\r\n\t\t\t\t\t\t\tpeerID: users[0],\r\n\t\t\t\t\t\t\tpeer,\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tsetPeers((prev) => [...prev, peer]);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\t//PERSON IN THE ROOM GETS NOTIFIED THAT SOMEBODY HAS JOINED\r\n\t\t\t\t//.on means recieving from backend\r\n\t\t\t\tsocketRef.current.on(\"user joined\", (payload) => {\r\n\t\t\t\t\tconst peer = addPeer(payload.signal, payload.callerID, stream);\r\n\r\n\t\t\t\t\tpeersRef.current.push({\r\n\t\t\t\t\t\tpeerID: payload.callerID,\r\n\t\t\t\t\t\tpeer,\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\tsetPeers((users) => [...users, peer]);\r\n\t\t\t\t});\r\n\t\t\t\tsocketRef.current.on(\"receiving returned signal\", (payload) => {\r\n\t\t\t\t\t// signal has been send to multiple now multiple users are sending back the signal to caller\r\n\t\t\t\t\tconst item = peersRef.current.find((p) => p.peerID === payload.id);\r\n\t\t\t\t\tconsole.log(item);\r\n\r\n\t\t\t\t\titem.peer.signal(payload.signal);\r\n\t\t\t\t});\r\n\t\t\t\t// \t\t});\r\n\t\t\t});\r\n\t}, []);\r\n\r\n\tfunction createPeer(userToAdmin, callerID, stream) {\r\n\t\tconsole.log(\"CREATE PEER\");\r\n\t\tconsole.log(stream);\r\n\t\tconst peer = new Peer({\r\n\t\t\tinitiator: true,\r\n\t\t\t//trickle wait for all the data to send makes it slow\r\n\t\t\ttrickle: false,\r\n\t\t\tstream,\r\n\t\t});\r\n\r\n\t\t//generates signal\r\n\t\t//sending to backend\r\n\t\tconsole.log(userToAdmin + \"  \" + callerID);\r\n\t\tpeer.on(\"signal\", (signal) => {\r\n\t\t\tsocketRef.current.emit(\"sending signal\", {\r\n\t\t\t\tuserToAdmin,\r\n\t\t\t\tcallerID,\r\n\t\t\t\tsignal,\r\n\t\t\t});\r\n\t\t});\r\n\r\n\t\tpeer.on(\"stream\", (stream) => {\r\n\t\t\tconsole.log(stream);\r\n\t\t\tuserVideo.current.srcObject = stream;\r\n\r\n\t\t\tsetStreamObj(stream);\r\n\t\t});\r\n\t\t// setPeers((prev) => [...prev, peer]);\r\n\r\n\t\treturn peer;\r\n\t}\r\n\r\n\tfunction addPeer(incomingSignal, callerID, stream) {\r\n\t\tconsole.log(\"Add Peer\");\r\n\t\tconst peer = new Peer({\r\n\t\t\tinitiator: false,\r\n\t\t\ttrickle: false,\r\n\t\t\tstream,\r\n\t\t});\r\n\t\t// 1 accepting the incoming signal that this will return the signal\r\n\t\tpeer.signal(incomingSignal);\r\n\r\n\t\tpeer.on(\"signal\", (signal) => {\r\n\t\t\tsocketRef.current.emit(\"returning signal\", { signal, callerID });\r\n\t\t});\r\n\r\n\t\treturn peer;\r\n\t}\r\n\r\n\tconst disconnect = () => {\r\n\t\tsocketRef.current.disconnect();\r\n\t};\r\n\r\n\tconst screenShare = () => {\r\n\t\tconst idRoom = shortid.generate();\r\n\t\taxios({\r\n\t\t\tmethod: \"post\",\r\n\t\t\turl: `api/${id}/${idRoom}`,\r\n\t\t\tidRoom,\r\n\t\t});\r\n\t\tsocketRef.current.emit(\"ssIdUser\", idRoom);\r\n\t\tconsole.log(idRoom);\r\n\t\tnavigator.mediaDevices\r\n\t\t\t//Cursor True is means sending cursor also of the person sharing screen to the person recieving the screen\r\n\t\t\t.getDisplayMedia({ cursor: true })\r\n\t\t\t.then((screenStream) => {\r\n\t\t\t\tconsole.log(\"SCREEN STREAM\", screenStream);\r\n\t\t\t\tconsole.log(userVideo.current);\r\n\t\t\t\tlet video = document.getElementById(\"ssVideo\");\r\n\r\n\t\t\t\tif (\"srcObject\" in video) {\r\n\t\t\t\t\tvideo.srcObject = screenStream;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tvideo.src = window.URL.createObjectURL(screenStream); // for older browsers\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvideo.play();\r\n\r\n\t\t\t\tpeers.map((peer, index) => {\r\n\t\t\t\t\tconsole.log(peer);\r\n\r\n\t\t\t\t\tpeer.replaceTrack(\r\n\t\t\t\t\t\t//0th track is the screen track\r\n\t\t\t\t\t\tstreamObj.getVideoTracks()[0],\r\n\t\t\t\t\t\tscreenStream.getVideoTracks()[0],\r\n\t\t\t\t\t\tstreamObj\r\n\t\t\t\t\t);\r\n\t\t\t\t});\r\n\t\t\t\tsetIsPresenting(true);\r\n\r\n\t\t\t\t//WHEN SHARING STOPS RETURN TO NORMAl STATE\r\n\t\t\t\t//RESPONSIBLE FOR WORKING OF STOP BUTTON\r\n\t\t\t\t// setScreenCastStream(screenStream);\r\n\t\t\t\t//\r\n\t\t\t\tscreenStream.getTracks()[0].onended = () => {\r\n\t\t\t\t\tpeers.map((peer, index) => {\r\n\t\t\t\t\t\tconsole.log(\"CALLED\");\r\n\t\t\t\t\t\tpeer.replaceTrack(\r\n\t\t\t\t\t\t\tscreenStream.getVideoTracks()[0],\r\n\t\t\t\t\t\t\tstreamObj.getVideoTracks()[0],\r\n\t\t\t\t\t\t\tstreamObj\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t});\r\n\t\t\t\t\tsetIsPresenting(false);\r\n\t\t\t\t};\r\n\t\t\t});\r\n\t};\r\n\r\n\treturn (\r\n\t\t<div class=\"videoScreen\">\r\n\t\t\t<div className=\"container\">\r\n\t\t\t\t<video\r\n\t\t\t\t\tclassName=\"adminVid\"\r\n\t\t\t\t\tid=\"adminVid\"\r\n\t\t\t\t\tref={userVideo}\r\n\t\t\t\t\tmuted\r\n\t\t\t\t\tautoPlay\r\n\t\t\t\t\tcontrols\r\n\t\t\t\t/>\r\n\t\t\t\t<video\r\n\t\t\t\t\tid=\"ssVideo\"\r\n\t\t\t\t\tref={ssVideo}\r\n\t\t\t\t\tmuted\r\n\t\t\t\t\tautoPlay\r\n\t\t\t\t\tplaysinline\r\n\t\t\t\t\tcontrols\r\n\t\t\t\t\thidden\r\n\t\t\t\t/>\r\n\t\t\t\t<canvas hidden id=\"localCanvas\"></canvas>\r\n\t\t\t</div>\r\n\r\n\t\t\t<div className=\"footer-body\">\r\n\t\t\t\t<Footer\r\n\t\t\t\t\tid={id}\r\n\t\t\t\t\tisPresenting={isPresenting}\r\n\t\t\t\t\tscreenShare={screenShare}\r\n\t\t\t\t\tisAdmin={isAdmin}\r\n\t\t\t\t\tsetJoinDisable={setJoinDisable}\r\n\t\t\t\t\tsetDisable={setDisable}\r\n\t\t\t\t\tdisconnect={disconnect}\r\n\t\t\t\t/>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default LiveCast;\r\n","import \"./App.css\";\nimport Home from \"./components/home/home\";\nimport Livecast from \"./components/liveCast/liveCast\";\nimport { BrowserRouter as Router, Switch, Route } from \"react-router-dom\";\nimport { fetchId } from \"./userService/userService\";\nimport { useEffect, useState } from \"react\";\n\nfunction App() {\n\tconst [id, setId] = useState();\n\tconst [disable, setDisable] = useState(false);\n\tconst [joinDisable, setJoinDisable] = useState(true);\n\n\tuseEffect(() => {\n\t\tfetchId().then((roomID) => {\n\t\t\tconsole.log(roomID.data.length);\n\t\t\tif (roomID.data.length === 0) {\n\t\t\t\tsetDisable(false);\n\t\t\t\tsetJoinDisable(true);\n\t\t\t} else {\n\t\t\t\tconsole.log(roomID);\n\n\t\t\t\tsetId(roomID.data[0]);\n\t\t\t\tsetDisable(true);\n\t\t\t\tsetJoinDisable(false);\n\t\t\t}\n\t\t});\n\t}, []);\n\n\treturn (\n\t\t<div className=\"App\">\n\t\t\t<Router>\n\t\t\t\t<Switch>\n\t\t\t\t\t<Route exact path=\"/\">\n\t\t\t\t\t\t<Home id={id} disable={disable} joinDisable={joinDisable} />\n\t\t\t\t\t</Route>\n\t\t\t\t\t<Route exact path=\"/:id\">\n\t\t\t\t\t\t<Livecast setJoinDisable={setJoinDisable} setDisable={setDisable} />\n\t\t\t\t\t</Route>\n\t\t\t\t</Switch>\n\t\t\t</Router>\n\t\t</div>\n\t);\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\n\nReactDOM.render(\n    <App />,\n  document.getElementById('root')\n);\n\n\n"],"sourceRoot":""}